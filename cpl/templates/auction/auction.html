{% extends 'layouts/base.html' %}
{% block title %}Auction{% endblock %}

{% block content %}
<div class="container my-4">
    <h1 class="h5 mb-4">Player Auction</h1>

  <form method="post">
  <div class="row g-3 align-items-end">
    <!-- Player selection -->
    <div class="col-md-3">
      <label class="form-label">Select Player</label>
      <select name="player_id" id="playerSelect" class="form-select" required onchange="showPlayerInfo()">
        <option value="">-- Choose Player --</option>
        {% for p in players %}
        <option value="{{ p.id }}" data-photo="{{ p.photo_url }}" data-role="{{ p.role }}">
          {{ p.name }} (ID: {{ p.id }})
        </option>
        {% endfor %}
      </select>
    </div>

    <!-- Team selection -->
    <div class="col-md-3">
      <label class="form-label">Sold To (Team)</label>
      <select name="team_id" class="form-select" required>
        <option value="">-- Choose Team --</option>
        {% for t in teams %}
        <option value="{{ t.id }}">{{ t.name }} ({{ t.short_code }})</option>
        {% endfor %}
      </select>
    </div>

    <!-- Sold amount -->
    <div class="col-md-3">
      <label class="form-label">Sold Amount</label>
      <input type="number" step="0.01" name="amount" class="form-control" placeholder="Enter amount" required>
    </div>

    <!-- Submit button -->
    <div class="col-md-3 d-flex">
      <button type="submit" class="btn btn-primary ms-auto">Submit</button>
    </div>
  </div>
</form>

        <!-- Player info card -->
        <div class="col-12 mt-3" id="playerInfo" style="display:none;">
            <div class="card p-4" style="min-height:500px; width:500px; margin:auto;">
                <img id="playerPhoto" src="" alt="Player Photo"
                     class="rounded mb-3 img-fluid"
                     style="height:500px; width:500px; object-fit:cover;">
                <p class="mb-0 text-center text-white"><strong>Role:</strong> <span id="playerRole"></span></p>
            </div>
        </div>

</div>

<script>
    function showPlayerInfo() {
      const select = document.getElementById("playerSelect");
      const option = select.options[select.selectedIndex];
      const photo = option.getAttribute("data-photo");
      const role = option.getAttribute("data-role");

      if (option.value) {
        document.getElementById("playerInfo").style.display = "block";
        document.getElementById("playerPhoto").src = photo || "{{ url_for('static', filename='image/default-player.png') }}";
        document.getElementById("playerRole").textContent = role || "Unknown";
      } else {
        document.getElementById("playerInfo").style.display = "none";
      }
    }
</script>
{% endblock %}
